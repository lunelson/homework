@import 'index';

$root: (
  inner-x: 2rem,
  inner-x-mods: (
    s: 0.5,
    form: 10px,
  ),
  inner-y-mods: (
    s: 1,
    m: 2,
    l: 4rem
  )
);

$media: (
  a: (breakpoint: 20em),
  b: (
    inner-x: 3rem,
    breakpoint: 30em
  ),
  c: (breakpoint: 40em),
);

@include homework-setup-core($output: false);

@function m-suffix($m: $curr-m) {
  @return if($m, '#{$m}__', '');
}

@function m-base-class($str, $solo: true, $m: $curr-m) {

}

@function m-mod-class($str) {
  @return selector-parse(".#{$str}, [class$='__#{$str}'], [class*='__#{$str} ']")
}

@each $m in join((null), media-keys()) {

  @include m($m) {

    $m__: m-suffix();

    #{base-class('#{$m__}span')} {
      width: calc(99.99999% * var(--span-n) / var(--span-d));

    }

  }
}

// #{m-mod-class('span')} {
//   & > * { --span-d: var(--span-n); }
// }

#{m-mod-class('span-2')} {
  --span-n: 2;
  & > * { --span-d: 2; }
}

// @each $m in join((null), media-keys()) {

//   @include m($m) {

//     $m__: m-suffix();

//     .#{$m__}w-unset { width: unset; }
//     .#{$m__}h-unset { height: unset; }

//     // dimensions/margin: auto
//     .#{$m__}w-auto { width: auto; }
//     .#{$m__}h-auto { height: auto; }
//     .#{$m__}my-auto, .#{$m__}mt-auto { margin-top: auto; }
//     .#{$m__}mx-auto, .#{$m__}mr-auto { margin-right: auto; }
//     .#{$m__}my-auto, .#{$m__}mb-auto { margin-bottom: auto; }
//     .#{$m__}mx-auto, .#{$m__}ml-auto { margin-left: auto; }

//     // dimensions/margin/padding: zero
//     .#{$m__}w-0 { width: 0; }
//     .#{$m__}h-0 { height: 0; }
//     .#{$m__}my-0, .#{$m__}mt-0 { margin-top: 0 !important; }
//     .#{$m__}mx-0, .#{$m__}mr-0 { margin-right: 0 !important; }
//     .#{$m__}my-0, .#{$m__}mb-0 { margin-bottom: 0 !important; }
//     .#{$m__}mx-0, .#{$m__}ml-0 { margin-left: 0 !important; }
//     .#{$m__}py-0, .#{$m__}pt-0 { padding-top: 0 !important; }
//     .#{$m__}px-0, .#{$m__}pr-0 { padding-right: 0 !important; }
//     .#{$m__}py-0, .#{$m__}pb-0 { padding-bottom: 0 !important; }
//     .#{$m__}px-0, .#{$m__}pl-0 { padding-left: 0 !important; }

//     // dimensions: 100%
//     .#{$m__}w-100 { width: 100%; }
//     .#{$m__}h-100 { height: 100%; }

//   }
// }

/*
    @function solo-span
    @function solo-push

    @function flow-span
    @function flow-push

    @mixin solo-cell($span, $push-l, $push-r) {}
    @mixin solo-cells($span, $push-l, $push-r) {}

    @mixin flow-cell($span, $push-l, $push-r) {}
    @mixin flow-cells($span, $push-l, $push-r) {}

    .span-[n], .push-[l|r]-[n]

    .flow-[y], .flow-x-[x]

      .span-[n], .push-[l|r]-[n]

    .grid-[y], .grid-x-[x]

      .row-[s]-[e], .row-span-[n]
      .col-[s]-[e], .col-span-[n]

*/

:root {
  --span-max: --grid-columns;
  --span-x: --span-max;
  --span-y: 1;
  --push-r: initial;
  --push-l: initial;
}

#{base-class('span')} {
  content: 'solo-span';
}

#{base-class('push-l', false)} {
  content: 'solo-push-l';
}
#{base-class('push-r', false)} {
  content: 'solo-push-r';
}

#{base-class('flow', false)} {
  content: 'flow';

  #{base-class('span')} {
    @at-root #{selector-insert('>')} {
      content: 'flow-span';
    }
  }

  #{base-class('push-l', false)} {
    @at-root #{selector-insert('>')} {
      content: 'flow-push-l';
    }
  }

  #{base-class('push-r', false)} {
    @at-root #{selector-insert('>')} {
      content: 'flow-push-r';
    }
  }
}

#{base-class('grid', false)} {
  content: 'grid';

  #{base-class('span', false)} {
    @at-root #{selector-insert('>')} {
      content: 'grid-span';
    }
  }

  // #{base-class('row', false)} {
  //   @at-root #{selector-insert('>')} {
  //     content: 'grid-row';
  //   }
  // }

  // #{base-class('col', false)} {
  //   @at-root #{selector-insert('>')} {
  //     content: 'grid-col';
  //   }
  // }
}

$max-columns: max-columns();
$pairs: ();
$map: ();


@for $n from 1 through max-columns() {
  .span-y-#{$n} { --span-y: #{$n}; }
  // .col-span-#{$n} { grid-column: span #{$n}; }
}

@for $b from 2 through (max-columns() + 1) {
  @for $a from 1 through ($b - 1) {
    // $pairs: append($pairs, #{$a}-#{$b});
    // $map: map-set($map, $a, append(map-get($map, $a) or (), ($a $b)));

    .row-#{$a}-#{$b} {
      grid-row: #{$a} / #{$b};
      // > * { --span-n: #{$b - $a}; }
    }
    .col-#{$a}-#{$b} {
      grid-column: #{$a} / #{$b};
      > * { --span-n: #{$b - $a}; }
    }
  }
}

.debug {
  out: inspect($pairs);
  out: inspect($map);
}
