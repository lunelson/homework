//                                     _
//                                    | |
//   ___ ___  _ __ ___ ______ ___  ___| |_ _   _ _ __
//  / __/ _ \| '__/ _ \______/ __|/ _ \ __| | | | '_ \
// | (_| (_) | | |  __/      \__ \  __/ |_| |_| | |_) |
//  \___\___/|_|  \___|      |___/\___|\__|\__,_| .__/
//                                              | |
//                                              |_|



@mixin homework-setup-root($modern: $homework-is-modern, $trim: true, $output: true) {

  $root-orig: $root !global;
  $media-orig: $media !global;
  $root: --parse-medium(map-merge($root-defaults, $root), 16px) !global;

  @if $output {

    @if $modern {
      :root {
        @include --medium-properties($root);
        --inner-width: calc(var(--outer-width) - (var(--outer-right) + var(--outer-left)));
      }
      html {
        font-size: var(--font-size);
        line-height: var(--line-height);
      }
    } @else {
      html {
        font-size: map-get($incoming-medium, 'font-size');
        line-height: map-get($incoming-medium, 'line-height');
      }
    }

  }

  $outgoing-medium: $root;
  @each $m, $incoming-medium in $media {

    @if not index(map-keys($incoming-medium), 'breakpoint') {
      @include throw-error('homework: one of your $media does not have a breakpoint key');
    }

    $outgoing-medium: --parse-medium(--deep-merge($outgoing-medium, $incoming-medium));
    $media: map-merge($media, ($m: $outgoing-medium)) !global;

    @if $output {
      @media #{--query-string(map-get($incoming-medium, 'breakpoint'))} {

        @if $modern {
          :root {
            @include --medium-properties($incoming-medium);
            --outer-width: #{map-get($outgoing-medium, 'outer-width')};
          }
        } @else {
          html {
            font-size: map-get($incoming-medium, 'font-size');
            line-height: map-get($incoming-medium, 'line-height');
          }
        }

      }
    }
  }
}
